<!DOCTYPE HTML>
<html lang="en">
    <head>
        
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title> | Kadalu </title>
<link href="/static/css/fav.png" rel="icon" type="image/x-icon" />
<link rel="apple-touch-icon" href="/static/css/fav.png" />
<meta name="generator" content="Nanoc 4.12.1">
<meta property="og:title" content=""/>
<meta name="author" content=""/>
<meta property="og:locale" content="en_US"/>
<meta name="description" content=""/>
<meta property="og:description" content=""/>
<link rel="canonical" href="/docs/kadalu-storage/main/devel/container-based-dev-setup-for-glusterfs/"/>
<meta property="og:url" content="/docs/kadalu-storage/main/devel/container-based-dev-setup-for-glusterfs/"/>
<meta property="og:site_name" content="Kadalu"/>
<meta property="og:image" content=""/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content=""/>
<meta name="twitter:card" content="summary_large_image"/>
<meta property="twitter:image" content=""/>
<meta property="twitter:title" content=""/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <link rel="stylesheet" href="/static/css/stylesheet.css">
<link rel="stylesheet" href="/static/css/syntax-highlight-emacs.css">
<script defer data-domain="kadalu.github.io" src="https://plausible.io/js/plausible.js"></script>
<script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.8.2/dist/alpine.min.js" defer></script>

    </head>
    <body>
        

<div class="bg-indigo-900">
    <div class="w-full px-5  m-auto py-5">
        <div class="lg:grid lg:grid-cols-12" x-data="{ menuOpen : false }">
            <div class="col-span-4 lg:col-span-2" style="height:40px">
                <a href="/"><img src="/static/css/logo.png" class="h-10 float-left" /></a>
                <button @click="menuOpen = !menuOpen" class="block absolute md:hidden right-7 top-5 w-8 h-8 text-gray-200 p-1">
                    <svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
                </button>
            </div>
            <div class="pt-2 col-span-8 lg:col-span-10">
                <nav class="absolute md:relative top-16 left-0 md:top-0 z-20 md:flex flex-col-reverse md:flex-row-reverse md:space-x-3 font-semibold w-full md:w-auto bg-indigo-900 shadow-md rounded-lg md:rounded-none md:shadow-none md:bg-transparent p-6 pt-5 md:p-0"
                     :class="{ 'flex' : menuOpen , 'hidden' : !menuOpen}"  @click.away="menuOpen = false"
                >
                    <a href="/blog" class="text-gray-300 hover:bg-gray-700 hover:text-white py-4 md:py-2 px-3 rounded-md text-sm font-medium">Blog</a>
                    <a href="/opensource" class="text-gray-300 hover:bg-gray-700 hover:text-white py-4 md:py-2 px-3 rounded-md text-sm font-medium">Open Source</a>
                    <a href="/docs" class="bg-gray-900 text-white py-2 px-3 rounded-md text-sm font-medium">Docs</a>
                </nav>
            </div>
        </div>
    </div>
</div>

        
        <div class="flex flex-col md:grid md:grid-cols-12 w-full" x-data="{docMenuOpen: false}">
            <div class="col-span-3 bg-gray-100" :class="{ 'block mr-10' : docMenuOpen , 'hidden md:block' : !docMenuOpen}" @click.away="docMenuOpen = false">
                <div class="py-5 px-5">
                    
                    <div class="p-5 bg-gray-200 border text-right rounded-lg">
                        <strong>Version: </strong>
                        <select class="input-field" onchange="location = '/docs/kadalu-storage/' + this.value;">
                            <option  value="latest">latest</option>
                            
                            <option selected value="main">main</option>
                            
                        </select>
                    </div>
                    
                    <h2 class="text-xl font-semibold mt-7">User Guide</h2>
                    <ul>
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/kadalu-storage/main/quick-start/">Quick Start</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/kadalu-storage/main/container-based-setup/">Container Based Setup</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/kadalu-storage/main/introduction/">Introduction</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/kadalu-storage/main/install/">Install</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/kadalu-storage/main/user-management/">User Management</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/kadalu-storage/main/config-snapshots/">Config Snapshots</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/kadalu-storage/main/pools/">Pools</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/kadalu-storage/main/volumes/">Volumes</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/kadalu-storage/main/faqs/">FAQs</a></li>
                        
                        
                    </ul>
                    
                    
                    
                </div>
            </div>
            <div id="main" class="col-span-9">
                <div class="py-5 px-10">
                    
                    <div class="mb-10">
                        <span class="inline-block font-semibold text-gray-700 py-1 text-xl">
                            <a href="/">
                                <svg class="w-6 h-6 inline-block" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg></a> / <a href="/docs/kadalu-storage">kadalu-storage</a> / <a href="/docs/kadalu-storage/main">main</a> / devel/container-based-dev-setup-for-glusterfs/</span>
                    </div>
                    
                    <button @click="docMenuOpen = !docMenuOpen" class="block md:hidden w-8 h-8 text-gray-600 mb-5">
                        <svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
                    </button>
                    <div class="mb-24 prose max-w-none prose-indigo">
                        <h1>Container-based development environment for GlusterFS</h1>
<div class="paragraph">
<p>It is not easy to set up an environment for GlusterFS development. Installing all the build dependencies in the main OS makes it cluttered. And clean removal of the dependencies becomes hard once the development is work is over.</p>
</div>
<div class="paragraph">
<p>Setting up using a Virtual machine for GlusterFS development is a better option compared to setting up in the host machine. But cleaning the Setup and re-setup is a tedious job. One has to make sure to clean all the previously installed files and set them up again for new enhancement.</p>
</div>
<div class="paragraph">
<p>Clone the GlusterFS repo using the following command after creating the fork of GlusterFS from Github UI.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span><span class="nv">gh_username</span><span class="o">=</span>&lt;your-user-name&gt;
<span class="gp">$</span><span class="w"> </span>git clone git@github.com:<span class="k">${</span><span class="nv">gh_username</span><span class="k">}</span>/glusterfs.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the following docker command to Start the GlusterFS dev container.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span><span class="nb">cd</span> <span class="nv">$GLUSTERFS_SRC</span>
<span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>docker run <span class="nt">-d</span> <span class="se">\</span>
      <span class="nt">-v</span> /sys/fs/cgroup/:/sys/fs/cgroup:ro <span class="se">\</span>
      <span class="nt">--privileged</span> <span class="se">\</span>
      <span class="nt">--name</span> server1 <span class="se">\</span>
      <span class="nt">-v</span> <span class="nv">$PWD</span>:/usr/src/glusterfs <span class="se">\</span>
      <span class="nt">-w</span> /usr/src/glusterfs <span class="se">\</span>
      <span class="nt">--hostname</span> server1 <span class="se">\</span>
      kadalu/gluster-build-env:latest</code></pre>
</div>
</div>
<div class="paragraph">
<p>That&#8217;s it!. Now check out a branch and start making changes. To test the changes, log in to the container and build the GlusterFS using the following commands.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>docker <span class="nb">exec</span> <span class="nt">-it</span> server1 /bin/bash
<span class="gp">#</span><span class="w"> </span>./autogen.sh
<span class="gp">#</span><span class="w"> </span>./configure <span class="nt">--disable-linux-io_uring</span>
<span class="gp">#</span><span class="w"> </span>make
<span class="gp">#</span><span class="w"> </span>make <span class="nb">install</span>
<span class="gp">#</span><span class="w"> </span>ldconfig</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once installed, start the Glusterd by running it in debug mode.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">#</span><span class="w"> </span>glusterd <span class="nt">-LDEBUG</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Check out a new branch and then make the changes locally. Test it quickly in the container, then submit a PR. After every change to the Gluster code in the host machine, run <code>make install</code> and <code>ldconfig</code> in the container.</p>
</div>
<div class="paragraph">
<p>To destroy the Setup, stop and delete the container. A restart of the container will not keep any state.</p>
</div>
<div class="paragraph">
<p><strong>Note</strong>: Restarting the container will not retain the installed state(Intentional). Run <code>make install</code> and <code>ldconfig</code> again if other steps are completed in the previous runs.</p>
</div>
<div class="paragraph">
<p>We hope you all like this. Let us know if anything we can do to improve the Gluster development process.</p>
</div>
<div class="paragraph">
<p><strong>Known issue</strong>: On Mac, the Docker Volume mount is very slow(<a href="https://forums.docker.com/t/file-access-in-mounted-volumes-extremely-slow-cpu-bound/8076/243">Refer</a>), building may take more time than doing it in the Virtual or host machine.</p>
</div>
<div class="paragraph">
<p>If any additional debug tools are required or a similar environment is required for Fedora/CentOS, send PRs to update Dockerfiles <a href="https://github.com/kadalu/moana/tree/main/extra/gluster/">here</a>.</p>
</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="bg-gray-800 text-gray-100 py-10">
    <div class="mx-auto w-full px-5 " style="min-height: 40vh">
        <div class="md:grid gap-2 md:grid-cols-4 md:gap-4">
            <div class="mb-10">
                <h2 class="text-xl font-semibold text-indigo-300">Community</h2>
                <ul>
                    <li><a href="/opensource">Open Source</a></li>
                    <li><a href="https://join.slack.com/t/kadalu/shared_invite/enQtNzg1ODQ0MDA5NTM2LWMzMTc5ZTJmMjk4MzI0YWVhOGFlZTJjZjY5MDNkZWI0Y2VjMDBlNzVkZmI1NWViN2U3MDNlNDJhNjE5OTBlOGU">Slack</a></li>
                    <li><a href="https://github.com/kadalu">Github</a></li>
                </ul>
            </div>

            <div class="mb-10">
                <h2 class="text-xl font-semibold text-indigo-300">Learn</h2>
                <ul>
                    <li><a href="/docs">Documentation</a></li>
                    <li><a href="/blog">Blog</a></li>
                    <li><a href="/faq">FAQ</a></li>
                    <li><a href="/rfcs">RFCs</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>
<div class="bg-gray-800 text-gray-100 py-10">
    <div class="mx-auto w-3/4 text-center text-gray-300 mb-10">
        &copy; 2022 Kadalu Community(https://github.com/kadalu). All Rights Reserved.
    </div>
</div>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-144588868-2"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-144588868-2');
</script>


    </body>
</html>
