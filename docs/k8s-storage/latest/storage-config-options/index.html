<!DOCTYPE HTML>
<html lang="en">
    <head>
        
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title> | Kadalu </title>
<link href="/static/css/fav.png" rel="icon" type="image/x-icon" />
<link rel="apple-touch-icon" href="/static/css/fav.png" />
<meta name="generator" content="Nanoc 4.12.1">
<meta property="og:title" content=""/>
<meta name="author" content=""/>
<meta property="og:locale" content="en_US"/>
<meta name="description" content=""/>
<meta property="og:description" content=""/>
<link rel="canonical" href="/docs/k8s-storage/latest/storage-config-options/"/>
<meta property="og:url" content="/docs/k8s-storage/latest/storage-config-options/"/>
<meta property="og:site_name" content="Kadalu"/>
<meta property="og:image" content=""/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content=""/>
<meta name="twitter:card" content="summary_large_image"/>
<meta property="twitter:image" content=""/>
<meta property="twitter:title" content=""/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <link rel="stylesheet" href="/static/css/stylesheet.css">
<link rel="stylesheet" href="/static/css/syntax-highlight-emacs.css">
<script defer data-domain="kadalu.io" src="https://plausible.io/js/plausible.js"></script>
<script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.8.2/dist/alpine.min.js" defer></script>

    </head>
    <body>
        

<div class="bg-indigo-900">
    <div class="w-full px-5  m-auto py-5">
        <div class="lg:grid lg:grid-cols-12" x-data="{ menuOpen : false }">
            <div class="col-span-4 lg:col-span-2" style="height:40px">
                <a href="/"><img src="/static/css/logo.png" class="h-10 float-left" /></a>
                <button @click="menuOpen = !menuOpen" class="block absolute md:hidden right-7 top-5 w-8 h-8 text-gray-200 p-1">
                    <svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
                </button>
            </div>
            <div class="pt-2 col-span-8 lg:col-span-10">
                <nav class="absolute md:relative top-16 left-0 md:top-0 z-20 md:flex flex-col-reverse md:flex-row-reverse md:space-x-3 font-semibold w-full md:w-auto bg-indigo-900 shadow-md rounded-lg md:rounded-none md:shadow-none md:bg-transparent p-6 pt-5 md:p-0"
                     :class="{ 'flex' : menuOpen , 'hidden' : !menuOpen}"  @click.away="menuOpen = false"
                >
                    <a href="/blog" class="text-gray-300 hover:bg-gray-700 hover:text-white py-4 md:py-2 px-3 rounded-md text-sm font-medium">Blog</a>
                    <a href="/company" class="text-gray-300 hover:bg-gray-700 hover:text-white py-4 md:py-2 px-3 rounded-md text-sm font-medium">Company</a>
                    <a href="/opensource" class="text-gray-300 hover:bg-gray-700 hover:text-white py-4 md:py-2 px-3 rounded-md text-sm font-medium">Open Source</a>
                    <a href="/services" class="text-gray-300 hover:bg-gray-700 hover:text-white py-4 md:py-2 px-3 rounded-md text-sm font-medium">Services</a>
                    <a href="/products" class="text-gray-300 hover:bg-gray-700 hover:text-white py-4 md:py-2 px-3 rounded-md text-sm font-medium">Products</a>
                    <a href="/docs" class="bg-gray-900 text-white py-2 px-3 rounded-md text-sm font-medium">Docs</a>
                </nav>
            </div>
        </div>
    </div>
</div>

        
        <div class="flex flex-col md:grid md:grid-cols-12 w-full" x-data="{docMenuOpen: false}">
            <div class="col-span-3 bg-gray-100" :class="{ 'block mr-10' : docMenuOpen , 'hidden md:block' : !docMenuOpen}" @click.away="docMenuOpen = false">
                <div class="py-5 px-5">
                    
                    <div class="p-5 bg-gray-200 border text-right rounded-lg">
                        <strong>Version: </strong>
                        <select class="input-field" onchange="location = '/docs/k8s-storage/' + this.value;">
                            <option selected value="latest">latest</option>
                            
                            <option  value="devel">devel</option>
                            
                        </select>
                    </div>
                    
                    <h2 class="text-xl font-semibold mt-7">User Guide</h2>
                    <ul>
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/k8s-storage/latest/quick-start/">Quick Start</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/k8s-storage/latest/introduction/">Introduction</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/k8s-storage/latest/setup/">Setup</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/k8s-storage/latest/setup-storage/">Setup Storage</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/k8s-storage/latest/csi-to-claim-persistent-volumes/">CSI to claim Persistent Volumes</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/k8s-storage/latest/try-kadalu/">Try Kadalu</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/k8s-storage/latest/external-gluster-storage/">External Gluster Storage</a></li>
                        
                        
                        
                        
                        <li class="text-indigo-600 font-semibold py-2 md:py-0">Storage Config Options</li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/k8s-storage/latest/mounted-block-volume/">Mounted Block Volume</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/k8s-storage/latest/storage-classes/">Storage Classes</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/k8s-storage/latest/troubleshooting/">Troubleshooting</a></li>
                        
                        
                    </ul>
                    
                    <h2 class="text-xl font-semibold mt-7">Use cases</h2>
                    <ul>
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/k8s-storage/latest/running-a-webserver/">Running a Webserver</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/k8s-storage/latest/running-minio/">Running Minio</a></li>
                        
                        
                    </ul>
                    
                    <h2 class="text-xl font-semibold mt-7">Articles</h2>
                    <ul>
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/k8s-storage/latest/how-it-works?/">How it works?</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/k8s-storage/latest/gluster-and-kadalu/">Gluster and Kadalu</a></li>
                        
                        
                    </ul>
                    
                    <h2 class="text-xl font-semibold mt-7">Developer Guide</h2>
                    <ul>
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/docs/k8s-storage/latest/get-involved/">Get Involved</a></li>
                        
                        
                    </ul>
                    
                    
                    
                </div>
            </div>
            <div id="main" class="col-span-9">
                <div class="py-5 px-10">
                    
                    <div class="mb-10">
                        <span class="inline-block font-semibold text-gray-700 py-1 text-xl">
                            <a href="/">
                                <svg class="w-6 h-6 inline-block" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg></a> / <a href="/docs/k8s-storage">k8s-storage</a> / <a href="/docs/k8s-storage/latest">latest</a> / storage-config-options/</span>
                    </div>
                    
                    <button @click="docMenuOpen = !docMenuOpen" class="block md:hidden w-8 h-8 text-gray-600 mb-5">
                        <svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
                    </button>
                    <div class="mb-24 prose max-w-none prose-indigo">
                        <h1>Kadalu Storage Config</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Storage configuration is core of the kadalu.io project. This config file provides details of which devices provide PVs, and what type (Replica1/Replica3 or other). Kadalu operator reads this config file, and starts the relevant gluster server pods exporting the storage provided in the config.</p>
</div>
<div class="paragraph">
<p>The features of kadalu project comes from options in storage-config file. In this document we will provide details of each options possible in config file.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_config_file_format">Config file format.</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let us look into below sample config file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kadalu-operator.storage/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">KadaluStorage</span>
<span class="na">metadata</span><span class="pi">:</span>
 <span class="c1"># This will be used as name of PV Hosting Volume</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">storage1</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">Replica1</span>
  <span class="na">storage</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">node</span><span class="pi">:</span> <span class="s">kube1</span>
      <span class="na">device</span><span class="pi">:</span> <span class="s">/dev/vdc</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For now,
* <code>apiVersion</code> will always be having value of <code>kadalu-operator.storage/v1alpha1</code>.
* <code>kind</code> will always be having value of <code>KadaluStorage</code>. kadalu operator only understands config of this <strong>kind</strong>.
* <code>metadata</code> is required, and should have an entry for 'name', which will be used as 'gluster&#8217;s volume name and pod names.
* <code>spec</code> field should be required, and should have <code>type</code> field.</p>
</div>
<div class="paragraph">
<p>The above 3 fields will be common for config files for all different modes.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_native_mode">Native mode</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this mode, the storage is provided from inside of the kubernetes cluster. Lets look at how native mode can be configured in each these options.</p>
</div>
<div class="sect2">
<h3 id="_type">Type</h3>
<div class="paragraph">
<p>Native mode is available with 3 <code>type</code> options. They are <code>Replica1</code>, <code>Replica2</code> and another <code>Replica3</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Replica1</strong> In this mode, Gluster will be started without high availability, i.e without replicate module. It will use just one storage, from which the RWX and RWO PVs will be carved out. This storage will be exposed by a gluster server pod, which gets spawned by kadalu operator.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kubectl kadalu storage-add storage-pool1 <span class="nt">--type</span><span class="o">=</span>Replica1 <span class="se">\</span>
    <span class="nt">--device</span> kube-nodename1:/dev/vdc</code></pre>
</div>
</div>
<div class="paragraph">
<p>To create a PVC from this storage, you need to provide <code>storageClassName</code> option as <code>kadalu.replica1</code>.</p>
</div>
</li>
<li>
<p><strong>Replica2</strong> In this mode, Gluster will be started with high availability, with 'tie-breaker' (or thin-arbiter in gluster speak) option. It will use 2 storage options, from which the RWX and RWO PVs will be carved out. This storage will be exposed by a gluster server pod, which gets spawned by kadalu operator. The <code>tiebreaker</code> node has to be managed outside, and if the user doesn&#8217;t want to host it, kadalu provides a free service for the same, which can be consumed by not providing any <code>tiebreaker</code> option :-)</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="nn">...</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">Replica2</span>
  <span class="na">storage</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">...</span>
    <span class="pi">-</span> <span class="s">...</span>
  <span class="na">tiebreaker</span><span class="pi">:</span>
    <span class="na">node</span><span class="pi">:</span> <span class="s">...</span>
    <span class="na">path</span><span class="pi">:</span> <span class="s">...</span>
<span class="nn">...</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To create a PVC from this storage, you need to provide <code>storageClassName</code> option as <code>kadalu.replica2</code>.</p>
</div>
</li>
<li>
<p><strong>Replica3</strong> In this mode, Gluster will started with high availability, ie, replicate module. It will require 3 storage options to be provided, and each storage will be one gluster server process pod running as pod.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="s">$ kubectl kadalu storage-add storage-pool1 --type=Replica3 \</span>
    <span class="s">--device kube-nodename1:/dev/vdc \</span>
    <span class="s">--device kube-nodename2:/dev/vdc \</span>
    <span class="s">--device kube-nodename3:/dev/vdc \</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To create a PVC from this storage, you need to provide <code>storageClassName</code> option as <code>kadalu.replica3</code>.</p>
</div>
</li>
<li>
<p><strong>Disperse</strong> Dispersed volumes are based on erasure codes. It stripes the encoded data of files, with some redundancy added, across multiple bricks in the volume. You can use dispersed volumes to have a configurable level of reliability with minimum space waste. This mode requires atleast 3 storages and increase the number of storages based on the requirement. Refer <a href="https://docs.gluster.org/en/latest/Administrator-Guide/Setting-Up-Volumes/#creating-dispersed-volumes">GlusterFS documentation</a> to know more about Disperse Volumes.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="s">$ kubectl kadalu storage-add storage-pool1 --type=Disperse \</span>
    <span class="s">--data 2 --redundancy 1          \</span>
    <span class="s">--device kube-nodename1:/dev/vdc \</span>
    <span class="s">--device kube-nodename2:/dev/vdc \</span>
    <span class="s">--device kube-nodename3:/dev/vdc \</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To create a PVC from this storage, you need to provide <code>storageClassName</code> option as <code>kadalu.disperse</code>.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_storage">Storage</h3>
<div class="paragraph">
<p>The native mode storage can be provided by many different types in kadalu. Lets look into each of those, with samples.</p>
</div>
<div class="sect3">
<h4 id="_storage_from_device">Storage from Device</h4>
<div class="paragraph">
<p>In this case, a device (<code>/dev/sd*</code> or similar), attached to a node in k8s cluster is provided as storage. The device is exported into the gluster server pod, and is formatted and mounted into specific brick path.</p>
</div>
<div class="paragraph">
<p>The sample command looks like below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kubectl kadalu storage-add storage-pool1 <span class="se">\</span>
    <span class="nt">--device</span> kube-nodename:/dev/vdc</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that both <code>node</code> and <code>device</code> fields are required. A device info without a node doesn&#8217;t contain all the required information for kadalu operator to start the brick process.</p>
</div>
<div class="paragraph">
<p>According to us, this is most common way of providing the storage to kadalu.</p>
</div>
<div class="paragraph">
<p>Also, if <code>device</code> option has a file as option, the same file will be formatted and used as device too. This is particularly helpful as a testing option, where from same backend multiple devices needs to be carved out. Our CI/CD tests use this approach.</p>
</div>
</div>
<div class="sect3">
<h4 id="_storage_from_path">Storage from path</h4>
<div class="paragraph">
<p>In this case, a directory path (/mnt/mount/path or similar) is exported as a brick from a node in the cluster as storage for gluster server process. This is particularly useful when a larger device is mounted and shared with other applications too.</p>
</div>
<div class="paragraph">
<p>Note that path option is valid only if the file system on the given path is xfs. path option is helpful for those who want to try kadalu in an existing setup. When path option is provided, kadalu operator doesn&#8217;t try to format and mount, but uses the path as export path for kadalu storage volume.</p>
</div>
<div class="paragraph">
<p>The sample command looks like below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kubectl kadalu storage-add storage-pool1 <span class="se">\</span>
    <span class="nt">--path</span> kube-nodename:/mnt/mount/export-path</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again here, both <code>node</code> and <code>path</code> are required fields. kadalu operator won&#8217;t have all required information to start gluster server pods without these two fields.</p>
</div>
</div>
<div class="sect3">
<h4 id="_storage_from_another_pvc">Storage from another PVC</h4>
<div class="paragraph">
<p>This is an interesting option, and makes sense specifically in a cloud environment, where a virtual storage device would be available as PVC in k8s cluster. kadalu can use a PVC, which is not bound to any 'node' as the storage, and provide multiple smaller PVCs through kadalu storageclass.</p>
</div>
<div class="paragraph">
<p>In this case, a PVC is exposed to kadalu&#8217;s server pod as storage through <code>volumes</code> option of pod config. With that the given PVC exposed into the server pods, we expose the given storage through gluster.</p>
</div>
<div class="paragraph">
<p>The sample config looks like below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kubectl kadalu storage-add storage-pool1 <span class="se">\</span>
    <span class="nt">--pvc</span> pvc-name-in-namespace</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that this PVC should be available in 'kadalu' namespace. Also there is no need of mentioning <code>node</code> field for this storage. k8s itself will start pod in relevant node in cluster.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_external_mode">External mode</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this mode, storage will be provided by gluster servers not managed by kadalu operator. Note that in this case, the gluster server can be running inside or outside k8s cluster.</p>
</div>
<div class="paragraph">
<p>The external mode can be specified with <code>type</code> as <code>External</code>. And when the type is External, the field it expects is <code>details</code>. Lets look at a sample, and then describe each of the options it takes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kubectl kadalu storage-add external-pool <span class="se">\</span>
    <span class="nt">--external</span> gluster_host:/gluster_volname</code></pre>
</div>
</div>
<div class="paragraph">
<p>Above,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>'gluster_host': This option takes one hostname or IP address, which is accessible from the k8s cluster.</p>
</li>
<li>
<p>'gluster_volname': Gluster volume name to be used as kadalu host storage volume. We prefer it to be a new volume created for kadalu.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Notice that to create PVC from External Storage config, you need to provide <code>storageClassName</code> option as <code>kadalu.{{ config-name }}</code>. In above case, it becomes <strong><code>kadalu.external-pool</code></strong>.</p>
</div>
<div class="sect2">
<h3 id="_how_it_works">How it works?</h3>
<div class="paragraph">
<p>kadalu operator doesn&#8217;t start any storage pods when 'External' type is used, but creates a <code>StorageClass</code> particular to this config, so when a PVC is created, the information is passed to the CSI drivers. The host-volume is mounted as below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="go">mount -t glusterfs {{ gluster_host }}:/{{ gluster_volname }} -o{{gluster_options}} /mount/point</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Other than this, the CSI volume&#8217;s behavior would be same for both Native mode, and External mode.</p>
</div>
</div>
<div class="sect2">
<h3 id="_external_storage_for_non_kadalu_mode">External Storage for non-kadalu mode.</h3>
<div class="paragraph">
<p>This option is provided in kadalu to access a gluster volume as a whole as PV. This is particularly useful if one wants to use an already existing Gluster volume as a PV (for example, a gluster volume created by heketi). We don&#8217;t recommend this for normal usage, as this mode would have scale limitations, and also would add more k8s resources likes StorageClass.</p>
</div>
<div class="paragraph">
<p>The example config file added for CI/CD gives an idea about options. Note that the options provided here looks same as whats given in storage config, but when kadalu operator creates the StorageClass with values (<code>natvie</code> vs <code>non-native</code>) supplied to field <code>kadalu_format</code> inorder to decide kadalu or non-kadalu mode. Refer the <a href="/docs/k8s-storage/latest/external-gluster-storage">external-storage document</a> for more information on this mode.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_archiving_persistent_volume_claims">Archiving Persistent Volume Claims</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Archiving a PVC retains its data when <code>delete</code> is called on it. This option can be enabled by specifying <code>pvReclaimPolicy</code> either through <code>StorageClass</code> or <code>Kadalu CLI</code>. The <code>pvReclaimPolicy</code> takes either <code>delete</code>, <code>archive</code> or <code>retain</code>. Default value is <code>delete</code> which deletes the PVC along with its data. <code>archive</code> option retains the data by renaming <code>pvc-123</code> to <code>archived-pvc-123</code>. <code>retain</code> option retains the data in place.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adding 'pvReclaimPolicy' through config file:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kadalu-operator.storage/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">KadaluStorage</span>
<span class="na">metadata</span><span class="pi">:</span>
<span class="c1"># This will be used as name of PV Hosting Volume</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">storage1</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">Replica1</span>
  <span class="na">pvReclaimPolicy</span><span class="pi">:</span> <span class="s">archive</span>
  <span class="na">storage</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">node</span><span class="pi">:</span> <span class="s">kube1</span>
      <span class="na">device</span><span class="pi">:</span> <span class="s">/dev/vdc</span></code></pre>
</div>
</div>
</li>
<li>
<p>Adding 'pvReclaimPolicy' through Kadalu CLI:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kubectl kadalu storage-add storage-pool1 <span class="se">\</span>
    <span class="nt">--device</span> kube1:/dev/vdc <span class="nt">--pv-reclaim-policy</span><span class="o">=</span>archive</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recreation_of_storage_pool_with_existing_volume_id">Recreation of storage-pool with existing Volume ID</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Every storage-pool created with device/path/pvc/external volumes will be associated with a unique Volume ID. In case of cleanup of Kadalu namespace and referencing the same existing volume will throw error since it has already been attached with unique ID, to avoid this and recreate the storage-pool specify the <code>volume_id</code> in storage-config or <code>--volume-id</code> in Kadalu CLI.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adding 'volume_id' through config file:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kadalu-operator.storage/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">KadaluStorage</span>
<span class="na">metadata</span><span class="pi">:</span>
<span class="c1"># This will be used as name of PV Hosting Volume</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">storage1</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">Replica1</span>
  <span class="na">volume_id</span><span class="pi">:</span> <span class="s">example-1234-volumeid-7890</span>
  <span class="na">storage</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">node</span><span class="pi">:</span> <span class="s">kube1</span>
      <span class="na">device</span><span class="pi">:</span> <span class="s">/dev/vdc</span></code></pre>
</div>
</div>
</li>
<li>
<p>Adding 'volume_id' through Kadalu CLI:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kubectl kadalu storage-add storage-pool1 <span class="se">\</span>
    <span class="nt">--device</span> kube1:/dev/vdc <span class="nt">--volume-id</span><span class="o">=</span>example-1234-volumeid-7890</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="bg-gray-800 text-gray-100 py-10">
    <div class="mx-auto w-full px-5 " style="min-height: 40vh">
        <div class="md:grid gap-2 md:grid-cols-4 md:gap-4">
            <div class="mb-10">
                <h2 class="text-xl font-semibold text-indigo-300">Kadalu</h2>
                <ul>
                    <li><a href="/products#k8s-native-storage">Kubernetes native Storage</a></li>
                    <li><a href="/products#kadalu-storage">Kadalu Storage</a></li>
                    <li><a href="/products#glusterup">GlusterFS monitoring</a></li>
                    <li><a href="/services">Services</a></li>
                    <li><a href="/services#features">Feature development</a></li>
                    <li><a href="/services#upgrade">Upgrade assistance</a></li>
                    <li><a href="/services#consultancy">Consultancy</a></li>
                    <li><a href="/security">Security</a></li>
                </ul>
            </div>

            <div class="mb-10">
                <h2 class="text-xl font-semibold text-indigo-300">Community</h2>
                <ul>
                    <li><a href="/opensource">Open Source</a></li>
                    <li><a href="https://join.slack.com/t/kadalu/shared_invite/enQtNzg1ODQ0MDA5NTM2LWMzMTc5ZTJmMjk4MzI0YWVhOGFlZTJjZjY5MDNkZWI0Y2VjMDBlNzVkZmI1NWViN2U3MDNlNDJhNjE5OTBlOGU">Slack</a></li>
                    <li><a href="https://github.com/kadalu">Github</a></li>
                    <!-- <li><a href="/office-hours">Office Hours</a></li> -->
                </ul>
            </div>

            <div class="mb-10">
                <h2 class="text-xl font-semibold text-indigo-300">Learn</h2>
                <ul>
                    <li><a href="/docs">Documentation</a></li>
                    <li><a href="/blog">Blog</a></li>
                    <li><a href="/faq">FAQ</a></li>
                    <li><a href="/rfcs">RFCs</a></li>
                    <!-- <li><a href="/compare">Compare</a></li> -->
                </ul>
            </div>

            <div class="mb-10">
                <h2 class="text-xl font-semibold text-indigo-300">Company</h2>
                <ul>
                    <li><a href="/company">About</a></li>
                    <li><a href="/contact">Contact</a></li>
                    <li><a href="/sitemap.xml">Sitemap</a></li>
                </ul>

                <h2 class="text-xl font-semibold text-indigo-300 mt-10">Write to us</h2>
                <ul>
                    <li><a href="mailto:hello@kadalu.io"><svg class="w-4 h-4 inline-block mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path><path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path></svg>hello@kadalu.io</a></li>
                </ul>

                <h2 class="text-xl font-semibold text-indigo-300 mt-10">Follow Us</h2>
                <ul>
                    <li><a href="https://twitter.com/kadaluio">Twitter</a></li>
                    <li><a href="https://linkedin.com/company/kadalu-io">Linkedin</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>
<div class="bg-gray-800 text-gray-100 py-10">
    <div class="mx-auto w-3/4 text-center text-gray-300 mb-10">
        &copy; 2022 Kadalu Software Private Limited. All Rights Reserved.
    </div>
</div>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-144588868-2"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-144588868-2');
</script>


    </body>
</html>
