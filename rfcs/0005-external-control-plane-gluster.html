<!DOCTYPE HTML>
<html lang="en">
    <head>
        
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title> | Kadalu </title>
<link href="/static/css/fav.png" rel="icon" type="image/x-icon" />
<link rel="apple-touch-icon" href="/static/css/fav.png" />
<meta name="generator" content="Nanoc 4.12.1">
<meta property="og:title" content=""/>
<meta name="author" content=""/>
<meta property="og:locale" content="en_US"/>
<meta name="description" content=""/>
<meta property="og:description" content=""/>
<link rel="canonical" href="/rfcs/0005-external-control-plane-gluster.html"/>
<meta property="og:url" content="/rfcs/0005-external-control-plane-gluster.html"/>
<meta property="og:site_name" content="Kadalu"/>
<meta property="og:image" content=""/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content=""/>
<meta name="twitter:card" content="summary_large_image"/>
<meta property="twitter:image" content=""/>
<meta property="twitter:title" content=""/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <link rel="stylesheet" href="/static/css/stylesheet.css">
<link rel="stylesheet" href="/static/css/syntax-highlight-emacs.css">
<script defer data-domain="kadalu.github.io" src="https://plausible.io/js/plausible.js"></script>
<script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.8.2/dist/alpine.min.js" defer></script>

    </head>
    <body>
        

<div class="bg-indigo-900">
    <div class="w-full px-5  m-auto py-5">
        <div class="lg:grid lg:grid-cols-12" x-data="{ menuOpen : false }">
            <div class="col-span-4 lg:col-span-2" style="height:40px">
                <a href="/"><img src="/static/css/logo.png" class="h-10 float-left" /></a>
                <button @click="menuOpen = !menuOpen" class="block absolute md:hidden right-7 top-5 w-8 h-8 text-gray-200 p-1">
                    <svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
                </button>
            </div>
            <div class="pt-2 col-span-8 lg:col-span-10">
                <nav class="absolute md:relative top-16 left-0 md:top-0 z-20 md:flex flex-col-reverse md:flex-row-reverse md:space-x-3 font-semibold w-full md:w-auto bg-indigo-900 shadow-md rounded-lg md:rounded-none md:shadow-none md:bg-transparent p-6 pt-5 md:p-0"
                     :class="{ 'flex' : menuOpen , 'hidden' : !menuOpen}"  @click.away="menuOpen = false"
                >
                    <a href="/blog" class="text-gray-300 hover:bg-gray-700 hover:text-white py-4 md:py-2 px-3 rounded-md text-sm font-medium">Blog</a>
                    <a href="/opensource" class="text-gray-300 hover:bg-gray-700 hover:text-white py-4 md:py-2 px-3 rounded-md text-sm font-medium">Open Source</a>
                    <a href="/docs" class="text-gray-300 hover:bg-gray-700 hover:text-white py-4 md:py-2 px-3 rounded-md text-sm font-medium">Docs</a>
                </nav>
            </div>
        </div>
    </div>
</div>

        
        <div class="flex flex-col md:grid md:grid-cols-12 w-full" x-data="{docMenuOpen: false}">
            <div class="col-span-3 bg-gray-100" :class="{ 'block mr-10' : docMenuOpen , 'hidden md:block' : !docMenuOpen}" @click.away="docMenuOpen = false">
                <div class="py-5 px-5">
                    
                    
                    <ul>
                        
                        <li class="py-2 md:py-0"><a href="/rfcs">Introduction</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/rfcs/0001-external-gluster-storage.html">0001 External Gluster Storage</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/rfcs/0002-test-framework-binnacle.html">0002 Test Framework Binnacle</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/rfcs/0003-kadalu-thin-arbiter-support.html">0003 Kadalu Thin Arbiter Support</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/rfcs/0004-gluster-error-codes.html">0004 Gluster Error Codes</a></li>
                        
                        
                        
                        
                        <li class="text-indigo-600 font-semibold py-2 md:py-0">0005 External Control Plane Gluster</li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/rfcs/0006-optimized-quota-feature-with-namespace.html">0006 Optimized Quota Feature With Namespace</a></li>
                        
                        
                        
                        
                        <li class="py-2 md:py-0"><a href="/rfcs/0007-Using-GlusterFS-directory-quota-for-external-gluster-volumes.html">0007 Using Glusterfs Directory Quota For External Gluster Volumes</a></li>
                        
                        
                        
                    </ul>
                    
                </div>
            </div>
            <div id="main" class="col-span-9">
                <div class="py-5 px-10">
                    
                    <button @click="docMenuOpen = !docMenuOpen" class="block md:hidden w-8 h-8 text-gray-600 mb-5">
                        <svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
                    </button>
                    <div class="mb-24 prose max-w-none prose-indigo">
                        <h1>External Control Plane for GlusterFS</h1>
<div class="sect1">
<h2 id="_summary">Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Glusterd is the default management daemon used for managing Gluster
Filesystem. It is responsible for maintaining the meta details and
health of the Cluster, Volumes, and other resources. When the number
of nodes increases per Cluster, then it becomes complicated to
maintain every resource in sync and ends up in too many connections
between nodes. For example, if a Cluster has 50 nodes, on any state
change, it will be updated in all the 50 nodes.  The new design will
not use Glusterd, instead delegates the GlusterFS management
responsibilities to an external ReST server.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authors">Authors</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Aravinda Vishwanathapura &lt;<a href="mailto:aravinda@kadalu.io">aravinda@kadalu.io</a>&gt;</p>
</li>
<li>
<p>Amar Tumballi &lt;<a href="mailto:amar@kadalu.io">amar@kadalu.io</a>&gt;</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_motivation">Motivation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Advantages compared to Glusterd design are,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Multi cluster support - Manage multiple clusters using a single
Control Server.</p>
</li>
<li>
<p>ReST APIs - Easily integrate with external applications or mobile
apps.</p>
</li>
<li>
<p>Multi-platform support - Manage Gluster Cluster easily from Linux,
Windows, Mac, or even from Mobile.</p>
</li>
<li>
<p>Scale - Easily scale Cluster with many nodes since no overhead of
syncing each Cluster state change to nodes.</p>
</li>
<li>
<p>Easily migrate the Control server to other nodes when required.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_detailed_design">Detailed design</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The control plane maintains all the states related to users, clusters,
volumes, and others. CLI or web UI will request a Control plane to
create/modify the resources. For example, CLI will send a request to
create Volume to Control plane and control plane converts as brick
create and start request for respective node agent. The node agent
will pick up the request and acknowledges it once complete.</p>
</div>
<div class="paragraph">
<p>The control plane never connects to nodes, so no access to the node
agent is required. All communications to a node should be done via a
message queue. Each node agent will maintain a heartbeat and updates
the information to the Control plane in periodic intervals.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/control-plane-gluster.png" alt="External Control Plane">
</div>
</div>
<div class="sect2">
<h3 id="_control_plane">Control plane</h3>
<div class="paragraph">
<p>The main server where all states will be stored and provides APIs
required for managing the Gluster filesystem. The primary
responsibility of the Control plane includes routing the messages to
respective nodes and listen to the response from the nodes. For
example, for Volume start request, send message to all participating
nodes and wait for the update from the node as brick started.</p>
</div>
<div class="paragraph">
<p>Responsibilities of Control plane are,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Routing messages to respective nodes.</p>
</li>
<li>
<p>Get the acknowledgment and update the states</p>
</li>
<li>
<p>Update the status once the node agent reports the task done.</p>
</li>
<li>
<p>Provide state of Volumes, Cluster, etc</p>
</li>
<li>
<p>Generate alerts based on the Health of Cluster</p>
</li>
<li>
<p>Multi cluster support</p>
</li>
<li>
<p>Authentication</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_webmobiledesktop_app">Web/Mobile/Desktop app:</h3>
<div class="paragraph">
<p>Web/Mobile UI, which consumes the APIs and provides a rich interface
for Gluster management.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cli">CLI</h3>
<div class="paragraph">
<p>CLI is also a ReST client, which interacts with the Control server to
manage the Gluster Cluster(s).</p>
</div>
</div>
<div class="sect2">
<h3 id="_node_agent">Node agent:</h3>
<div class="paragraph">
<p>Node agent will be installed in all the nodes and communicates with
the control plane for all actions. Maintains a heartbeat with the
control plane and exports the status.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Listen to messages from the Control plane and execute.</p>
</li>
<li>
<p>Acknowledge and update the progress.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>At the start of the node agent, it connects with the Control plane and
keeps a persistent connection. The control plane will maintain the
task queue for each node, each node agent will subscribe to its task
queue and perform the action. Unlike Glusterd, all tasks are executed
asynchronously from the node agent and acknowledged to Control
Server. For example, to start a brick process, the Control plane puts
a message as "START_BRICK" with status "QUEUED", Node agents pick the
task and updates the status as "STARTING" and then it starts the Brick
process. Once the Brick process starts successfully, the node agent
updates the state as "STARTED". In case of failure, the node agent
will update the state as "FAILED" and the reason for failure. If the
node agent is unable to connect to Control Plane or node is down, then
the task state will remain as "QUEUED" and node state will be changed
to "UNREACHABLE".</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/state-life-cycle.jpg" alt="Task Lifecycle">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_communication_between_control_server_and_node_agent">Communication between Control Server and Node agent:</h3>
<div class="paragraph">
<p>The control server will not have access to node agents; Node agents
will connect to the Control server and gets the details. Node agents
can establish a WebSocket connection so that the Control server can
push the notification when needed.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitoring_and_dashboard">Monitoring and Dashboard</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The dashboard of the Control plane shows the real-time status of the
cluster. Visualizing historical data is possible by using Prometheus
or other similar solutions.</p>
</div>
<div class="paragraph">
<p>The control plane will have up to date details about the health of the
cluster, Volume utilization, and other metrics. The control plane will
not store the historical data, and Prometheus can be used for
visualizing historical data.</p>
</div>
<div class="paragraph">
<p>Control plane can become Prometheus exporter by exposing a new API
<code>/metrics</code>. Prometheus server running in the same node as the control
plane can pick up the metrics from the control plane. Use the Grafana
dashboard to visualize the metrics from Prometheus. (Note: Grafana
dashboards can be embedded into any website, may be embedded in the
WebUI of control plane)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_backup_and_recovery_of_cluster_metadata">Backup and Recovery of Cluster metadata</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Every change to Cluster meta information will be versioned. On a
handshake, each node agent downloads the cluster meta information and
saves it locally. If the control server node goes down, then it can be
started in some other node by restoring data from any node agent(Or
choose the node agent which contains the latest cluster data).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_high_availability_of_control_plane">High availability of Control plane</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Control Server is no different from a web server, use all the
available scaling and load balancing techniques for hosting it. Use
the "Streaming Replication" feature of Postgresql for disaster
recovery.</p>
</div>
<div class="paragraph">
<p>More on this topic TBD. High availability of the database is also
possible by using the Gluster Volume as storage for the
database. (This is based on the fact that Replica 3 Gluster volume can
be run as service without the need of Glusterd)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_usage">Usage:</h2>
<div class="sectionbody">
<div class="paragraph">
<p>CLI commands used in the following examples. CLI is one of the
mechanisms to control the Cluster.  Other ways to communicate with the
Control plane are Web UI, ReST APIs, etc.</p>
</div>
<div class="sect2">
<h3 id="_user_management">User management</h3>
<div class="paragraph">
<p>In the case of the self-hosted Control server, the first user will
become the Admin user. Create more users using admin privileges.</p>
</div>
<div class="paragraph">
<p>Granular user permissions that enable them to access specific
resources on the Cluster, such as Volumes, Nodes, and Storage
devices.</p>
</div>
<div class="paragraph">
<p>Log in to the Control server by running the following command, and the
token will be saved in <code>~/.gluster/token.json</code> on a successful login.</p>
</div>
<div class="paragraph">
<p>All consecutive commands will use the token saved in the file
mentioned above. To logout, run the following command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu login
<span class="go">Username:
Password:
Logged in successfully. The token is saved to ~/.kadalu/token.json</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If the Gluster control plane is self-managed, then use the <code>--url</code>
parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu login <span class="nt">--url</span> https://node1.example.com:8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>All consecutive commands will use the token saved in the file
mentioned above. To logout, run the following command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu <span class="nb">logout</span>
<span class="go">Logged out successfully</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_create_cluster_and_nodes_registration">Create Cluster and nodes registration</h3>
<div class="paragraph">
<p>Cluster registration is Optional. The default cluster will be created
with the name <code>default</code>. Registering Cluster provides logical
namespace to differentiate the volumes. For example, one Cluster can
be <code>mycluster</code>, and another one can be <code>backup_cluster</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu cluster add mycluster
<span class="go">Cluster creation request sent.</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>After registering a Cluster(or for the default Cluster), the Control
server will generate a token. Set the token as an environment
variable(Other ways to set Token TBD) in each storage node and start
the Node agent. The node agent will register itself with the Control
server by identifying it with the token.</p>
</div>
<div class="paragraph">
<p>Once the node agent registers with the Control Server, it establishes
a persistent connection(Or polling) to listen to the events from the
Control server.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cluster_status">Cluster Status</h3>
<div class="paragraph">
<p>Cluster status can be checked using,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu cluster status</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cluster status will show the state of each node. If a node connects to
the control server, then it shows that node is Online, else it shows
Unreachable.</p>
</div>
</div>
<div class="sect2">
<h3 id="_device_management">Device Management</h3>
<div class="paragraph">
<p>Register the Storage devices using the following command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu device add <span class="nt">-c</span> mycluster node1.example.com <span class="nt">--device</span> /dev/vdc</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu device add <span class="nt">-c</span> mycluster node1.example.com <span class="nt">--path</span> /exports/bricks/b1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Multiple device or path can be specified for a node.</p>
</div>
<div class="paragraph">
<p>The storage device is not yet part of any Volume but helps to design
utilities like dynamic Volume provisioning like below command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu volume create <span class="nt">-c</span> mycluster gvol1 <span class="nt">--replica3</span> <span class="nt">--size</span> 100GiB</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_volume_create">Volume Create</h3>
<div class="paragraph">
<p>Run the following command to create the Volume.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu volume create <span class="nt">-c</span> mycluster gvol1  <span class="se">\</span>
      node1.example.com:/exports/storage1
<span class="go">Volume creation request sent.</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The volume will start automatically once created. Use <code>--no-start</code> if
only Create is required.</p>
</div>
</div>
<div class="sect2">
<h3 id="_volume_start">Volume Start</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu volume start <span class="nt">-c</span> mycluster gvol1
<span class="go">Volume start request sent.</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_volume_stop">Volume Stop</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu volume stop <span class="nt">-c</span> mycluster gvol1
<span class="go">Volume stop request sent.</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_volume_delete">Volume Delete</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu volume delete <span class="nt">-c</span> mycluster gvol1
<span class="go">Volume delete request sent.</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_status">Status</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu volume status <span class="nt">-c</span> mycluster gvol1</code></pre>
</div>
</div>
<div class="paragraph">
<p>The controller waits for node agents to acknowledge the status, so the
intermediate state introduced for every action. For example, “Volume
Creating”, “Volume Created” and “Volume Create Failed”</p>
</div>
<div class="paragraph">
<p><strong>Status</strong>: Creating, Created, CreateFailed, Starting, Started,
StartFailed, Stopping, Stopped, StopFailed, Deleting, DeleteFailed</p>
</div>
<div class="paragraph">
<p><strong>Note</strong>: Export failure reason also from Node agents. If the node is
down then, Status can show the same("Unreachable")</p>
</div>
</div>
<div class="sect2">
<h3 id="_failure_report">Failure report!</h3>
<div class="paragraph">
<p>The following command shows the last failure details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu failurereport
<span class="go">Volume creation failed in the following nodes.

node1.example.com - Failed due to ENOENT.

Reason: ENOENT failures are mainly due to root directory is not
present for which brick directory is specified. For example, if brick
on this node specified as `/exports/storage1`, then `/exports`
directory is not present in that node.

How to fix:

Log in to the node and create the root directory.</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_volume_options">Volume Options</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu volume <span class="nb">set</span> <span class="nt">-c</span> mycluster gvol1 &lt;optname&gt; &lt;optvalue&gt;
<span class="gp">$</span><span class="w"> </span>kadalu volume reset <span class="nt">-c</span> mycluster gvol1 &lt;optname&gt;
<span class="gp">$</span><span class="w"> </span>kadalu volume get <span class="nt">-c</span> mycluster gvol1 <span class="o">[</span>&lt;optname&gt;]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Control Server will validate Volume Options. The changed option will
be picked by the Node agent to regenerate the brick, self-heal volfile
when necessary. It also notifies the running daemon to reload to get
the reconfigured volfile content.</p>
</div>
<div class="paragraph">
<p>If only client option changes, then the wrapper script, which started
the mount/client, will pick up the latest configuration and reloads
the client process.</p>
</div>
</div>
<div class="sect2">
<h3 id="_volume_expand">Volume expand</h3>
<div class="paragraph">
<p>Start the node agent(Set env variable or config file to point to
Control plane) and then run the following command to expand Volume.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu volume <span class="nb">expand</span> <span class="nt">-c</span> mycluster gvol1
<span class="go">       node4.example.com:/export/storage2</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note</strong>: Connected clients will get notification about Graph change.</p>
</div>
</div>
<div class="sect2">
<h3 id="_rebalance">Rebalance</h3>
<div class="paragraph">
<p>Start rebalance process using,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu volume rebalance start <span class="nt">-c</span> mycluster gvol1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Other commands available are, <code>stop</code>, <code>status</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_volume_shrink">Volume Shrink</h3>
<div class="paragraph">
<p>Not for Version 1. TBD(Remove brick, Rebalance etc)</p>
</div>
</div>
<div class="sect2">
<h3 id="_geo_replication">Geo-replication</h3>
<div class="paragraph">
<p>Preparing the remote nodes for accepting ssh connections from master
nodes is required(A separate tool will be provided for the same).</p>
</div>
</div>
<div class="sect2">
<h3 id="_create_geo_replication_session_using">Create Geo-replication session using,</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu geo-replication create <span class="nt">-c</span> mycluster <span class="se">\</span>
    <span class="nt">--remote-user</span> geouser <span class="nt">--remote-cluster</span> mycluster2 <span class="se">\</span>
    mastervol remotevol
<span class="go">Geo-replication session creation request sent.
ID: 068EB4E3-7E00-4CB5-899A-4C522AEC0F98</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The geo-rep session will start automatically after create. To avoid
this, <code>--no-start</code> can be used.</p>
</div>
<div class="paragraph">
<p>Start Geo-replication session using,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>kadalu geo-replication start &lt;ID&gt; <span class="nt">-c</span> mycluster
<span class="go">Geo-replication start request sent.</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, other commands available are: stop, delete, config-get,
config-set, config-reset, and status.</p>
</div>
<div class="paragraph">
<p><strong>Bonus</strong>: The control plane itself can decide Active/Passive worker
per subvolume.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_snapshot">Snapshot</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TBD. Two possible approaches available are,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Special sexattr on the mount can trigger snapshots in all bricks.</p>
</li>
<li>
<p>Similar to the existing method, Control Server can notify all mounts
to enable barrier and notify node agents to take backend snapshot.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_quota_management">Quota management</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="bg-gray-800 text-gray-100 py-10">
    <div class="mx-auto w-full px-5 " style="min-height: 40vh">
        <div class="md:grid gap-2 md:grid-cols-4 md:gap-4">
            <div class="mb-10">
                <h2 class="text-xl font-semibold text-indigo-300">Community</h2>
                <ul>
                    <li><a href="/opensource">Open Source</a></li>
                    <li><a href="https://join.slack.com/t/kadalu/shared_invite/enQtNzg1ODQ0MDA5NTM2LWMzMTc5ZTJmMjk4MzI0YWVhOGFlZTJjZjY5MDNkZWI0Y2VjMDBlNzVkZmI1NWViN2U3MDNlNDJhNjE5OTBlOGU">Slack</a></li>
                    <li><a href="https://github.com/kadalu">Github</a></li>
                </ul>
            </div>

            <div class="mb-10">
                <h2 class="text-xl font-semibold text-indigo-300">Learn</h2>
                <ul>
                    <li><a href="/docs">Documentation</a></li>
                    <li><a href="/blog">Blog</a></li>
                    <li><a href="/faq">FAQ</a></li>
                    <li><a href="/rfcs">RFCs</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>
<div class="bg-gray-800 text-gray-100 py-10">
    <div class="mx-auto w-3/4 text-center text-gray-300 mb-10">
        &copy; 2022 Kadalu Community(https://github.com/kadalu). All Rights Reserved.
    </div>
</div>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-144588868-2"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-144588868-2');
</script>


    </body>
</html>
