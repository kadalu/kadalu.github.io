

<!DOCTYPE HTML>
<html lang="en">
    <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charSet="utf-8"/>
    <title></title>
    <link rel="stylesheet" href="/static/css/bulma-0.9.4.min.css">
    <link rel="stylesheet" href="/static/css/stylesheet.css">
    <link rel="stylesheet" href="/static/css/syntax-highlight-emacs.css">
    <script defer src="/static/alpinejs.persist-3.10.5.min.js"></script>
    <script defer src="/static/alpinejs-3.10.5.min.js"></script>

    <meta name="generator" content="Nanoc 4.12.1">
    
<link href="/favicon.ico" rel="icon" type="image/x-icon" />
<link rel="apple-touch-icon" href="/favicon.ico" />
<meta name="generator" content="Nanoc 4.12.1">
<meta property="og:title" content=""/>
<meta name="author" content=""/>
<meta property="og:locale" content="en_US"/>
<meta name="description" content=""/>
<meta property="og:description" content=""/>
<link rel="canonical" href="/kadalu-storage/main/pools/"/>
<meta property="og:url" content="/kadalu-storage/main/pools/"/>
<meta property="og:site_name" content="Kadalu"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content=""/>

<meta name="twitter:card" content="summary"/>
<meta name="twitter:image" content="https://kadalu.tech/images/logo-icon-spaced.png"/>
<meta property="og:image" content="https://kadalu.tech/images/logo-icon-spaced.png"/>

<meta name="twitter:site" content="https://kadalu.tech"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content=""/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />


    <script defer data-domain="docs.kadalu.tech" src="https://plausible.io/js/script.js"></script>
</head>

    <body>
        <div id="main" x-data="{version: 'main', menuShow: true}">
            <nav class="navbar pr-4" role="navigation" aria-label="main navigation" x-data="{showing: false}">
    <div class="navbar-brand has-text-left">
        <a class="navbar-item" href="/">
            <span class="has-text-primary is-size-4">kadalu</span><span class="has-text-grey is-size-4 ml-1">DOCS</span>
        </a>

        <!-- <div class="field">
             <p class="control has-icons-left mx-2 mt-4">
             <input class="input" type="text" placeholder="Search">
             <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="icon is-small is-left pl-1" style="width: 1.5em">
             <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd" />
             </svg>
             </p>
             </div> -->

        <a role="button" class="navbar-burger" aria-label="menu" :class="showing ? 'is-active' : ''" aria-expanded="false" @click="showing = !showing">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
        
    </div>

    <div class="navbar-end" x-show="showing">
        <a class="navbar-item" href="https://kadalu.tech">
            kadalu.tech
        </a>
    </div>
    <div class="navbar-end is-hidden-touch">
        <a class="navbar-item" href="https://kadalu.tech">
            kadalu.tech
        </a>
    </div>
</nav>

            <div class="tabs is-small mb-0">
                <ul>
                    
                    <li class="is-active">
                        <a href="/kadalu-storage/latest" class="mb-0">
                            <span>Kadalu Storage</span>
                        </a>
                    </li>
                    
                    <li class="">
                        <a href="/k8s-storage/latest" class="mb-0">
                            <span>Kadalu Storage (Kubernetes Native)</span>
                        </a>
                    </li>
                    
                    <li class="">
                        <a href="/console/latest" class="mb-0">
                            <span>Kadalu Storage Console</span>
                        </a>
                    </li>
                    
                    <li class="">
                        <a href="/binnacle/latest" class="mb-0">
                            <span>Binnacle</span>
                        </a>
                    </li>
                    
                </ul>
            </div>
            <div class="is-flex" x-data="{menuShow: $persist(true), headings: document.getElementsByClassName('heading')}">
                <div class="is-flex-grow-0 is-flex-shrink-0 has-background-info-light" style="overflow-x: hidden;transition: all 200ms ease-in-out;" :style="{'flex-basis': menuShow ? '230px' : '0'}">
                    <aside class="menu mb-4" :class="menuShow ? 'px-4' : 'px-6'">
                        
                        <p class="menu-label mt-4">
                            User Guide
                        </p>
                        <ul class="menu-list">
                            
                            
                            <li class=""><a class="" href="/kadalu-storage/main/quick-start/">Quick Start</a></li>
                            
                            
                            <li class=""><a class="" href="/kadalu-storage/main/container-based-setup/">Container Based Setup</a></li>
                            
                            
                            <li class=""><a class="" href="/kadalu-storage/main/introduction/">Introduction</a></li>
                            
                            
                            <li class=""><a class="" href="/kadalu-storage/main/install/">Install</a></li>
                            
                            
                            <li class=""><a class="" href="/kadalu-storage/main/user-management/">User Management</a></li>
                            
                            
                            <li class=""><a class="" href="/kadalu-storage/main/setup/">Setting up the Storage Cluster</a></li>
                            
                            
                            <li class=""><a class="" href="/kadalu-storage/main/config-snapshots/">Config Snapshots</a></li>
                            
                            
                            <li class=""><a class="is-active" href="/kadalu-storage/main/pools/">Pools</a></li>
                            
                            
                            <li class=""><a class="" href="/kadalu-storage/main/faqs/">FAQs</a></li>
                            
                        </ul>
                        
                        <p class="menu-label mt-4">
                            Tutorials
                        </p>
                        <ul class="menu-list">
                            
                            
                            <li class=""><a class="" href="/kadalu-storage/main/cron-based-config-backup/">Cron-based config backup</a></li>
                            
                        </ul>
                        
                    </aside>
                </div>
                <div class="is-flex-grow-0 is-flex-shrink-0 has-background-info-light has-text-right" style="flex-basis: 20px; position:relative" @click="menuShow = !menuShow">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" x-show="menuShow" class="icon is-clickable" style="position: sticky; top:2px">
                        <path fill-rule="evenodd" d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z" clip-rule="evenodd" />
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" x-show="!menuShow" class="icon is-clickable" style="position: sticky; top:2px">
                        <path fill-rule="evenodd" d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z" clip-rule="evenodd" />
                    </svg>
                </div>
                <div class="is-flex-grow-1 is-flex-shrink-1">
                    <div class="px-6 mt-4 mb-6 content is-flex" id="main-content">
                        <div class="is-flex-grow-1 is-flex-shrink-1">
                            <div class="p-2 has-text-right mb-6">
                                <span>Version</span>
                                <div class="select is-small is-rounded">
                                    <select x-model="version" style="width: 100%" @change="window.location=`/kadalu-storage/${version}`">
                                        <option>latest</option>
                                        
                                        <option>1.1.x</option>
                                        
                                        <option>1.0.x</option>
                                        
                                        <option>main</option>
                                        
                                    </select>
                                </div>
                            </div>
                            <div class="doc-content">
                                <h1>Kadalu Storage Pools</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Kadalu Storage pool is a collection of one or more export directories from multiple servers.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_pool_creation">Pool Creation</h3>
<div class="paragraph">
<p>Create a Kadalu Storage Pool with Storage units from multiple Storage nodes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">[root@server1 ~]#</span><span class="w"> </span>kadalu pool create pool1 server1.example.com:/exports/pool1/s1
<span class="go">Pool pool1 created successfully
ID: 02b6a3a4-e704-47ee-bb05-e541a561a921</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Where</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pool1</code> is the Pool name</p>
</li>
<li>
<p><code>server1.example.com</code> is the node from which the Storage unit will be exported.</p>
</li>
<li>
<p><code>/exports/pool1/s1</code> is the mounted path of Storage Unit.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Automatically add nodes to the Cluster that are specified in the Pool create request by adding <code>--auto-add-nodes</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">[root@server1 ~]#</span><span class="w"> </span>kadalu pool create pool1 <span class="se">\</span>
    server1.example.com:/exports/pool1/s1   <span class="se">\</span>
    <span class="nt">--auto-add-nodes</span>
<span class="go">Pool pool1 created successfully
ID: 02b6a3a4-e704-47ee-bb05-e541a561a921</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a Replicated or Mirrored Pool</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">[root@server1 ~]#</span><span class="w"> </span>kadalu pool create pool1 <span class="se">\</span>
    replica server1.example.com:/exports/pool1/s1 <span class="se">\</span>
            server2.example.com:/exports/pool1/s2 <span class="se">\</span>
            server3.example.com:/exports/pool1/s3
<span class="go">Pool pool1 created successfully
ID: 02b6a3a4-e704-47ee-bb05-e541a561a921</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Using <code>mirror</code> is also supported</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">[root@server1 ~]#</span><span class="w"> </span>kadalu pool create pool1 <span class="se">\</span>
    mirror server1.example.com:/exports/pool1/s1 <span class="se">\</span>
           server2.example.com:/exports/pool1/s2 <span class="se">\</span>
           server3.example.com:/exports/pool1/s3
<span class="go">Pool pool1 created successfully
ID: 02b6a3a4-e704-47ee-bb05-e541a561a921</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, GlusterFS syntax is also supported</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">[root@server1 ~]#</span><span class="w"> </span>kadalu pool create pool1 replica 3 <span class="se">\</span>
    server1.example.com:/exports/pool1/s1 <span class="se">\</span>
    server2.example.com:/exports/pool1/s2 <span class="se">\</span>
    server3.example.com:/exports/pool1/s3
<span class="go">Pool pool1 created successfully
ID: 02b6a3a4-e704-47ee-bb05-e541a561a921</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>By default, pools are started on create. Use <code>--no-start</code> to override this behavior.</p>
</li>
<li>
<p>If the Storage unit path is not a mounted directory then use <code>--allow-root-partition</code> option (Not yet implemented). This is not an optimal setup since the Kadalu Pool can fill up the root partition or other applications can fill up Kadalu Pool.</p>
</li>
<li>
<p>To import a Pool, Use <code>--pool-id</code> option to set the Same Pool ID to the imported Pool. If required Pool ID to be reused is not saved, it can be found in server volfile or at storage unit path as extended attribute in hexadecimal format.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">[root@server1 ~]#</span><span class="w"> </span>kadalu pool create pool1 <span class="se">\</span>
    server1.example.com:/exports/pool1/s1 <span class="se">\</span>
   <span class="nt">--pool-id</span><span class="o">=</span>02b6a3a4-e704-47ee-bb05-e541a561a921</code></pre>
</div>
</div>
</li>
<li>
<p>To reuse a Storage unit directory that was part of other Pool earlier, use <code>--reuse-storage-unit</code> (Not yet implemented, only applicable if the Storage unit directory is empty).</p>
</li>
<li>
<p>To allow using Replicate/Mirrored/Disperse Storage units from same node, use <code>--from-same-node</code>. This is not an optimal setup since it does not provide high availability for the distribute group if one node goes down (Not yet implemented).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Ports for the Storage Unit are assigned automatically (<code>49252</code> to <code>49452</code>) while creating the Pool. Restarting the Pool will not change the Ports of the Storage units. The Pool info command will show the assigned ports. It is also possible to manually specify the Port while creating the Pool.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">[root@server1 ~]#</span><span class="w"> </span>kadalu pool create pool1 <span class="se">\</span>
    mirror server1.example.com:4501:/exports/pool1/s1 <span class="se">\</span>
           server2.example.com:4501:/exports/pool1/s2 <span class="se">\</span>
           server3.example.com:4501:/exports/pool1/s3
<span class="go">Pool pool1 created successfully
ID: 02b6a3a4-e704-47ee-bb05-e541a561a921</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_pool_expansion_and_rebalance">Pool Expansion and Rebalance</h3>
<div class="paragraph">
<p>Expand an already created Kadalu Storage Pool with storage units from multiple storage nodes.</p>
</div>
<div class="paragraph">
<p>Example,</p>
</div>
<div class="paragraph">
<p>Create a Replicated or Mirror Kadalu Storage Pool 'pool1' with 3 different storage nodes and 3 storage units.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">[root@server1 ~]#</span><span class="w"> </span>kadalu pool create pool1 <span class="se">\</span>
    mirror server1.example.com:/exports/pool1/s1 <span class="se">\</span>
           server2.example.com:/exports/pool1/s2 <span class="se">\</span>
           server3.example.com:/exports/pool1/s3
<span class="go">Pool pool1 created successfully
ID: 03c6a3a4-e704-47ee-bb05-e541a561a875</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Expand Kadalu Storage Pool <code>pool1</code> by adding more Storage units.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Note:</p>
<div class="literalblock">
<div class="content">
<pre>Pool type, distribute group count, replica count, data and redundant storage unit count should be the same as when the Kadalu Storage Pool was created.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>For example above Kadalu Storage Pool being of type mirror 3, it has 1 distribute group with 3 storage units. Hence during pool expansion Kadalu Storage expects distribute group being a multiple of 1.</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">[root@server1 ~]#</span><span class="w"> </span>kadalu pool <span class="nb">expand </span>pool1   <span class="se">\</span>
    mirror server1.example.com:/exports/pool1/s1_e <span class="se">\</span>
           server2.example.com:/exports/pool1/s2_e <span class="se">\</span>
           server3.example.com:/exports/pool1/s3_e
<span class="go">Pool pool1 expanded successfully
ID: 03c6a3a4-e704-47ee-bb05-e541a561a875

Proceed to the rebalancing of pool pool1 by following the below steps.
To start the rebalancing of pool: kadalu pool rebalance-start pool1.
To force stop the rebalancing of pool: kadalu pool rebalance-stop pool1.</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_rebalance">Rebalance</h4>
<div class="paragraph">
<p>During the expansion of pool, Kadalu Storage also fixes the layout of all expanded storage units, i.e., it triggers the creation of directories in the expanded storage units, to maintain the same directory structure as in storage units before expansion.</p>
</div>
<div class="paragraph">
<p>Once the layout of the expanded storage units is fixed, data migration can commence. Data migration involves recalculating the hash of files and distributing them across storage units.</p>
</div>
<div class="paragraph">
<p>To start and stop the rebalance (i.e., data migration), follow the steps displayed after the pool expansion.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">[root@server1 ~]#</span><span class="w"> </span>kadalu rebalance start pool1
<span class="go">Rebalance of Pool pool1 started.</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">[root@server1 ~]#</span><span class="w"> </span>kadalu rebalance stop pool1
<span class="go">Rebalance of Pool pool1 started.</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Note:</p>
<div class="literalblock">
<div class="content">
<pre>The Rebalance process, if restarted in the middle of completion, will start scanning storage units from the beginning and not from the point where it stopped</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>To view the status of Rebalance processes,</p>
</div>
<div class="paragraph">
<p><code>kadalu rebalance status pool1</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">[root@server1 ~]#</span><span class="w"> </span>kadalu rebalance status pool1
<span class="go">
Name                       : pool1
Type                       : Distributed Mirror
ID                         : 03c6a3a4-e704-47ee-bb05-e541a561a875
Fix-Layout Status          : complete
Total Dirs Scanned         : 3
Duration                   : 0
Progress                   : 100.00 %
Estimate Seconds           : 0
Scanned                    : 1.13MiB / 1.13MiB

Pool pool1 Rebalance Status            : complete
Total Number of Rebalance Process       : 6
Number of Completed Rebalance Process   : 6
Number of Failed Rebalance Process      : 0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Where,</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Fix-Layout Status</code> is status of fix-layout process after pool expansion.</p>
</li>
<li>
<p><code>Total Dirs Scanned</code> indicates total number of dirs which was scanned and added to newer storage units.</p>
</li>
<li>
<p><code>Duration</code> is the time taken for fix-layout process to complete.</p>
</li>
<li>
<p><code>Progress</code> is the percentage amount of progress made with migration of data (Rebalance).</p>
</li>
<li>
<p><code>Estimate Seconds</code> is the estimated amount of time which might be taken for completion of migration of data.</p>
</li>
<li>
<p><code>Scanned</code> indicates in Bytes, files scanned out of total files.</p>
</li>
<li>
<p><code>Rebalance Status</code> can be of complete, partial, failed and not-started indicating the status of Rebalance at pool level.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To view the <code>Rebalance Status</code> of each storage-unit : <code>kadalu rebalance status &lt;pool&gt; --detail</code>.</p>
</div>
</div>
</div>
                            </div>
                        </div>
                        <div class="p-4 is-flex-grow-1 is-flex-shrink-1 is-hidden-touch" x-data="{headings: document.getElementById('main-content').getElementsByTagName('h2')}" style="position:relative">
                            <div style="position: sticky;top:20px">
                                <h4 x-show="headings.length > 0" class="is-size-6 has-text-grey">ON THIS PAGE</h4>
                                <template x-for="heading in headings">
                                    <a class="is-block mb-2" :href="`#${heading.id}`" x-text="heading.textContent"></a>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="footer has-background-primary has-text-white pt-6">
    <div class="columns">
        <div class="column">
            <h2 class="has-font-weight-semibold is-size-5 is-underlined py-2">Community</h2>
            <a class="is-block has-text-white" target="_blank" href="https://join.slack.com/t/kadalu/shared_invite/enQtNzg1ODQ0MDA5NTM2LWMzMTc5ZTJmMjk4MzI0YWVhOGFlZTJjZjY5MDNkZWI0Y2VjMDBlNzVkZmI1NWViN2U3MDNlNDJhNjE5OTBlOGU">Community Slack</a>
            <a class="is-block has-text-white" target="_blank" href="https://github.com/kadalu">Github</a>
            <a class="is-block has-text-white" target="_blank" href="https://kadalu.tech">kadalu.tech</a>
        </div>
    </div>
    <div class="has-text-centered mt-6">
        Copyright &copy; 2022 Kadalu Technologies Private Limited.
    </div>
</div>

        </div>
    </body>
</html>
